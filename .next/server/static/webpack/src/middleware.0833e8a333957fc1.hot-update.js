"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("src/middleware",{

/***/ "(middleware)/./src/middleware.ts":
/*!***************************!*\
  !*** ./src/middleware.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(middleware)/./node_modules/next/dist/esm/server/web/exports/next-response.js\");\n/* harmony import */ var next_auth_jwt__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next-auth/jwt */ \"(middleware)/./node_modules/next-auth/jwt/index.js\");\n/* harmony import */ var next_auth_jwt__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(next_auth_jwt__WEBPACK_IMPORTED_MODULE_1__);\n\n\nasync function middleware(request) {\n    // Allow Socket.IO polling and WebSocket upgrade requests\n    if (request.nextUrl.pathname.startsWith(\"/api/socket\")) {\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].next();\n    }\n    const token = await (0,next_auth_jwt__WEBPACK_IMPORTED_MODULE_1__.getToken)({\n        req: request\n    });\n    const isAuthenticated = !!token;\n    // List of public paths that don't require authentication\n    const publicPaths = [\n        \"/\",\n        \"/auth/signin\",\n        \"/auth/signup\",\n        \"/api/auth\"\n    ];\n    const isPublicPath = publicPaths.some((path)=>request.nextUrl.pathname.startsWith(path));\n    // List of auth paths that should redirect to /posts if authenticated\n    const authPaths = [\n        \"/auth/signin\",\n        \"/auth/signup\"\n    ];\n    const isAuthPath = authPaths.some((path)=>request.nextUrl.pathname.startsWith(path));\n    if (isAuthenticated && isAuthPath) {\n        // Redirect authenticated users to posts page\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].redirect(new URL(\"/posts\", request.url));\n    }\n    if (!isAuthenticated && !isPublicPath) {\n        // Redirect unauthenticated users to sign in page\n        const signInUrl = new URL(\"/auth/signin\", request.url);\n        signInUrl.searchParams.set(\"callbackUrl\", request.url);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].redirect(signInUrl);\n    }\n    return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].next();\n}\n// Configure which routes to protect\nconst config = {\n    matcher: [\n        \"/posts/:path*\",\n        \"/messages/:path*\",\n        \"/profile/:path*\",\n        \"/api/((?!auth|socket).*)/:path*\",\n        \"/auth/signin\",\n        \"/auth/signup\"\n    ]\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKG1pZGRsZXdhcmUpLy4vc3JjL21pZGRsZXdhcmUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBMEM7QUFDRjtBQUd6QixlQUFlRSxXQUFXQyxPQUE0QjtJQUNuRSx5REFBeUQ7SUFDekQsSUFBSUEsUUFBUUMsT0FBTyxDQUFDQyxRQUFRLENBQUNDLFVBQVUsQ0FBQyxnQkFBZ0I7UUFDdEQsT0FBT04sa0ZBQVlBLENBQUNPLElBQUk7SUFDMUI7SUFFQSxNQUFNQyxRQUFRLE1BQU1QLHVEQUFRQSxDQUFDO1FBQUVRLEtBQUtOO0lBQVE7SUFDNUMsTUFBTU8sa0JBQWtCLENBQUMsQ0FBQ0Y7SUFFMUIseURBQXlEO0lBQ3pELE1BQU1HLGNBQWM7UUFBQztRQUFLO1FBQWdCO1FBQWdCO0tBQVk7SUFDdEUsTUFBTUMsZUFBZUQsWUFBWUUsSUFBSSxDQUFDQyxDQUFBQSxPQUNwQ1gsUUFBUUMsT0FBTyxDQUFDQyxRQUFRLENBQUNDLFVBQVUsQ0FBQ1E7SUFHdEMscUVBQXFFO0lBQ3JFLE1BQU1DLFlBQVk7UUFBQztRQUFnQjtLQUFlO0lBQ2xELE1BQU1DLGFBQWFELFVBQVVGLElBQUksQ0FBQ0MsQ0FBQUEsT0FDaENYLFFBQVFDLE9BQU8sQ0FBQ0MsUUFBUSxDQUFDQyxVQUFVLENBQUNRO0lBR3RDLElBQUlKLG1CQUFtQk0sWUFBWTtRQUNqQyw2Q0FBNkM7UUFDN0MsT0FBT2hCLGtGQUFZQSxDQUFDaUIsUUFBUSxDQUFDLElBQUlDLElBQUksVUFBVWYsUUFBUWdCLEdBQUc7SUFDNUQ7SUFFQSxJQUFJLENBQUNULG1CQUFtQixDQUFDRSxjQUFjO1FBQ3JDLGlEQUFpRDtRQUNqRCxNQUFNUSxZQUFZLElBQUlGLElBQUksZ0JBQWdCZixRQUFRZ0IsR0FBRztRQUNyREMsVUFBVUMsWUFBWSxDQUFDQyxHQUFHLENBQUMsZUFBZW5CLFFBQVFnQixHQUFHO1FBQ3JELE9BQU9uQixrRkFBWUEsQ0FBQ2lCLFFBQVEsQ0FBQ0c7SUFDL0I7SUFFQSxPQUFPcEIsa0ZBQVlBLENBQUNPLElBQUk7QUFDMUI7QUFFQSxvQ0FBb0M7QUFDN0IsTUFBTWdCLFNBQVM7SUFDcEJDLFNBQVM7UUFDUDtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7S0FDRDtBQUNILEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vc3JjL21pZGRsZXdhcmUudHM/ZDE5OSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcbmltcG9ydCB7IGdldFRva2VuIH0gZnJvbSAnbmV4dC1hdXRoL2p3dCdcbmltcG9ydCB7IE5leHRSZXF1ZXN0V2l0aEF1dGggfSBmcm9tICduZXh0LWF1dGgvbWlkZGxld2FyZSdcblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gbWlkZGxld2FyZShyZXF1ZXN0OiBOZXh0UmVxdWVzdFdpdGhBdXRoKSB7XG4gIC8vIEFsbG93IFNvY2tldC5JTyBwb2xsaW5nIGFuZCBXZWJTb2NrZXQgdXBncmFkZSByZXF1ZXN0c1xuICBpZiAocmVxdWVzdC5uZXh0VXJsLnBhdGhuYW1lLnN0YXJ0c1dpdGgoJy9hcGkvc29ja2V0JykpIHtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLm5leHQoKVxuICB9XG5cbiAgY29uc3QgdG9rZW4gPSBhd2FpdCBnZXRUb2tlbih7IHJlcTogcmVxdWVzdCB9KVxuICBjb25zdCBpc0F1dGhlbnRpY2F0ZWQgPSAhIXRva2VuXG5cbiAgLy8gTGlzdCBvZiBwdWJsaWMgcGF0aHMgdGhhdCBkb24ndCByZXF1aXJlIGF1dGhlbnRpY2F0aW9uXG4gIGNvbnN0IHB1YmxpY1BhdGhzID0gWycvJywgJy9hdXRoL3NpZ25pbicsICcvYXV0aC9zaWdudXAnLCAnL2FwaS9hdXRoJ11cbiAgY29uc3QgaXNQdWJsaWNQYXRoID0gcHVibGljUGF0aHMuc29tZShwYXRoID0+IFxuICAgIHJlcXVlc3QubmV4dFVybC5wYXRobmFtZS5zdGFydHNXaXRoKHBhdGgpXG4gIClcblxuICAvLyBMaXN0IG9mIGF1dGggcGF0aHMgdGhhdCBzaG91bGQgcmVkaXJlY3QgdG8gL3Bvc3RzIGlmIGF1dGhlbnRpY2F0ZWRcbiAgY29uc3QgYXV0aFBhdGhzID0gWycvYXV0aC9zaWduaW4nLCAnL2F1dGgvc2lnbnVwJ11cbiAgY29uc3QgaXNBdXRoUGF0aCA9IGF1dGhQYXRocy5zb21lKHBhdGggPT4gXG4gICAgcmVxdWVzdC5uZXh0VXJsLnBhdGhuYW1lLnN0YXJ0c1dpdGgocGF0aClcbiAgKVxuXG4gIGlmIChpc0F1dGhlbnRpY2F0ZWQgJiYgaXNBdXRoUGF0aCkge1xuICAgIC8vIFJlZGlyZWN0IGF1dGhlbnRpY2F0ZWQgdXNlcnMgdG8gcG9zdHMgcGFnZVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTCgnL3Bvc3RzJywgcmVxdWVzdC51cmwpKVxuICB9XG5cbiAgaWYgKCFpc0F1dGhlbnRpY2F0ZWQgJiYgIWlzUHVibGljUGF0aCkge1xuICAgIC8vIFJlZGlyZWN0IHVuYXV0aGVudGljYXRlZCB1c2VycyB0byBzaWduIGluIHBhZ2VcbiAgICBjb25zdCBzaWduSW5VcmwgPSBuZXcgVVJMKCcvYXV0aC9zaWduaW4nLCByZXF1ZXN0LnVybClcbiAgICBzaWduSW5Vcmwuc2VhcmNoUGFyYW1zLnNldCgnY2FsbGJhY2tVcmwnLCByZXF1ZXN0LnVybClcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KHNpZ25JblVybClcbiAgfVxuXG4gIHJldHVybiBOZXh0UmVzcG9uc2UubmV4dCgpXG59XG5cbi8vIENvbmZpZ3VyZSB3aGljaCByb3V0ZXMgdG8gcHJvdGVjdFxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcbiAgbWF0Y2hlcjogW1xuICAgICcvcG9zdHMvOnBhdGgqJyxcbiAgICAnL21lc3NhZ2VzLzpwYXRoKicsXG4gICAgJy9wcm9maWxlLzpwYXRoKicsXG4gICAgJy9hcGkvKCg/IWF1dGh8c29ja2V0KS4qKS86cGF0aConLFxuICAgICcvYXV0aC9zaWduaW4nLFxuICAgICcvYXV0aC9zaWdudXAnXG4gIF1cbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJnZXRUb2tlbiIsIm1pZGRsZXdhcmUiLCJyZXF1ZXN0IiwibmV4dFVybCIsInBhdGhuYW1lIiwic3RhcnRzV2l0aCIsIm5leHQiLCJ0b2tlbiIsInJlcSIsImlzQXV0aGVudGljYXRlZCIsInB1YmxpY1BhdGhzIiwiaXNQdWJsaWNQYXRoIiwic29tZSIsInBhdGgiLCJhdXRoUGF0aHMiLCJpc0F1dGhQYXRoIiwicmVkaXJlY3QiLCJVUkwiLCJ1cmwiLCJzaWduSW5VcmwiLCJzZWFyY2hQYXJhbXMiLCJzZXQiLCJjb25maWciLCJtYXRjaGVyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(middleware)/./src/middleware.ts\n");

/***/ })

});